import{a as h,b as p,c as m}from"./chunk-25TAOAZK.mjs";import{d as H,f as E,g as x,h as z,i as S,j as f}from"./chunk-LR65XHSF.mjs";import{b as i}from"./chunk-TIH6ARYP.mjs";import o from"tweetnacl";var n=class n extends h{constructor(e){super();let r=i.fromHexInput(e);if(r.toUint8Array().length!==n.LENGTH)throw new Error(`PublicKey length should be ${n.LENGTH}`);this.key=r}toUint8Array(){return this.key.toUint8Array()}toString(){return this.key.toString()}verifySignature(e){let{message:r,signature:a}=e,y=i.fromHexInput(r).toUint8Array(),l=a.toUint8Array();return o.sign.detached.verify(y,l,this.key.toUint8Array())}serialize(e){e.serializeBytes(this.key.toUint8Array())}static deserialize(e){let r=e.deserializeBytes();return new n(r)}static load(e){let r=e.deserializeBytes();return new n(r)}};n.LENGTH=32;var u=n,t=class t extends p{constructor(e){super();let r=i.fromHexInput(e);if(r.toUint8Array().length!==t.LENGTH)throw new Error(`PrivateKey length should be ${t.LENGTH}`);this.signingKeyPair=o.sign.keyPair.fromSeed(r.toUint8Array().slice(0,t.LENGTH))}toUint8Array(){return this.signingKeyPair.secretKey.slice(0,t.LENGTH)}toString(){return i.fromHexInput(this.toUint8Array()).toString()}sign(e){let r=i.fromHexInput(e),a=o.sign.detached(r.toUint8Array(),this.signingKeyPair.secretKey);return new d(a)}serialize(e){e.serializeBytes(this.toUint8Array())}static deserialize(e){let r=e.deserializeBytes();return new t(r)}static generate(){let e=o.sign.keyPair();return new t(e.secretKey.slice(0,t.LENGTH))}publicKey(){let e=this.signingKeyPair.publicKey;return new u(e)}static fromDerivationPath(e,r){if(!E(e))throw new Error(`Invalid derivation path ${e}`);return t.fromDerivationPathInner(e,f(r))}static fromDerivationPathInner(e,r,a=H){let{key:y,chainCode:l}=x(t.SLIP_0010_SEED,r),A=S(e).map(c=>parseInt(c,10)),{key:v}=A.reduce((c,K)=>z(c,K+a),{key:y,chainCode:l});return new t(v)}};t.LENGTH=32,t.SLIP_0010_SEED="ed25519 seed";var P=t,s=class s extends m{constructor(e){super();let r=i.fromHexInput(e);if(r.toUint8Array().length!==s.LENGTH)throw new Error(`Signature length should be ${s.LENGTH}`);this.data=r}toUint8Array(){return this.data.toUint8Array()}toString(){return this.data.toString()}serialize(e){e.serializeBytes(this.data.toUint8Array())}static deserialize(e){let r=e.deserializeBytes();return new s(r)}static load(e){let r=e.deserializeBytes();return new s(r)}};s.LENGTH=64;var d=s;export{u as a,P as b,d as c};
//# sourceMappingURL=chunk-WHLYF2O4.mjs.map