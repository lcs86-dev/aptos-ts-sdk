import{a as f}from"./chunk-BGYRAOYY.mjs";import{a as A}from"./chunk-TFLLMOUE.mjs";import{a as _}from"./chunk-4YD32UV6.mjs";import{b as y}from"./chunk-WHLYF2O4.mjs";import{b as m}from"./chunk-QPKG6ZE7.mjs";import{b as a}from"./chunk-72XSCUWL.mjs";import{a as b}from"./chunk-AH44UPM4.mjs";import{d as S,g as d}from"./chunk-BIRTH26D.mjs";import{d as C,e as h,f as w,g as k,h as T,j as O,k as q,l as v}from"./chunk-BQSE5HHW.mjs";import{b as g,c as p}from"./chunk-PQWOB2ZY.mjs";import{a as l}from"./chunk-6FBKUTGF.mjs";async function M(t){let{aptosConfig:n,accountAddress:e}=t,{data:o}=await g({aptosConfig:n,originMethod:"getInfo",path:`accounts/${a.from(e).toString()}`});return o}async function co(t){let{aptosConfig:n,accountAddress:e,options:o}=t;return p({aptosConfig:n,originMethod:"getModules",path:`accounts/${a.from(e).toString()}/modules`,params:{ledger_version:o?.ledgerVersion,start:o?.offset,limit:o?.limit??1e3}})}async function ao(t){return t.options?.ledgerVersion!==void 0?G(t):b(async()=>G(t),`module-${t.accountAddress}-${t.moduleName}`,1e3*60*5)()}async function G(t){let{aptosConfig:n,accountAddress:e,moduleName:o,options:r}=t,{data:s}=await g({aptosConfig:n,originMethod:"getModule",path:`accounts/${a.from(e).toString()}/module/${o}`,params:{ledger_version:r?.ledgerVersion}});return s}async function io(t){let{aptosConfig:n,accountAddress:e,options:o}=t;return p({aptosConfig:n,originMethod:"getTransactions",path:`accounts/${a.from(e).toString()}/transactions`,params:{start:o?.offset,limit:o?.limit}})}async function uo(t){let{aptosConfig:n,accountAddress:e,options:o}=t;return p({aptosConfig:n,originMethod:"getResources",path:`accounts/${a.from(e).toString()}/resources`,params:{ledger_version:o?.ledgerVersion,start:o?.offset,limit:o?.limit??999}})}async function K(t){let{aptosConfig:n,accountAddress:e,resourceType:o,options:r}=t,{data:s}=await g({aptosConfig:n,originMethod:"getResource",path:`accounts/${a.from(e).toString()}/resource/${o}`,params:{ledger_version:r?.ledgerVersion}});return s.data}async function Q(t){let{aptosConfig:n,authenticationKey:e,options:o}=t,r=await K({aptosConfig:n,accountAddress:"0x1",resourceType:"0x1::account::OriginatingAddress",options:o}),{address_map:{handle:s}}=r,c=a.from(e);try{let i=await S({aptosConfig:n,handle:s,data:{key:c.toString(),key_type:"address",value_type:"address"},options:o});return a.from(i)}catch(i){if(i instanceof l&&i.data.error_code==="table_item_not_found")return c;throw i}}async function go(t){let{aptosConfig:n,accountAddress:e}=t,r={owner_address:{_eq:a.from(e).toStringLong()},amount:{_gt:0}},c=await d({aptosConfig:n,query:{query:q,variables:{where_condition:r}},originMethod:"getAccountTokensCount"});return c.current_token_ownerships_v2_aggregate.aggregate?c.current_token_ownerships_v2_aggregate.aggregate.count:0}async function po(t){let{aptosConfig:n,accountAddress:e,options:o}=t,s={owner_address:{_eq:a.from(e).toStringLong()},amount:{_gt:0}};o?.tokenStandard&&(s.token_standard={_eq:o?.tokenStandard});let c={query:T,variables:{where_condition:s,offset:o?.pagination?.offset,limit:o?.pagination?.limit,order_by:o?.orderBy}};return(await d({aptosConfig:n,query:c,originMethod:"getAccountOwnedTokens"})).current_token_ownerships_v2}async function Ao(t){let{aptosConfig:n,accountAddress:e,collectionAddress:o,options:r}=t,s=a.from(e).toStringLong(),c=a.from(o).toStringLong(),i={owner_address:{_eq:s},current_token_data:{collection_id:{_eq:c}},amount:{_gt:0}};r?.tokenStandard&&(i.token_standard={_eq:r?.tokenStandard});let u={query:O,variables:{where_condition:i,offset:r?.pagination?.offset,limit:r?.pagination?.limit,order_by:r?.orderBy}};return(await d({aptosConfig:n,query:u,originMethod:"getAccountOwnedTokensFromCollectionAddress"})).current_token_ownerships_v2}async function fo(t){let{aptosConfig:n,accountAddress:e,options:o}=t,s={owner_address:{_eq:a.from(e).toStringLong()},amount:{_gt:0}};o?.tokenStandard&&(s.current_collection={token_standard:{_eq:o?.tokenStandard}});let c={query:w,variables:{where_condition:s,offset:o?.pagination?.offset,limit:o?.pagination?.limit,order_by:o?.orderBy}};return(await d({aptosConfig:n,query:c,originMethod:"getAccountCollectionsWithOwnedTokens"})).current_collection_ownership_v2_view}async function lo(t){let{aptosConfig:n,accountAddress:e}=t,o=a.from(e).toStringLong(),s=await d({aptosConfig:n,query:{query:v,variables:{address:o}},originMethod:"getAccountTransactionsCount"});return s.account_transactions_aggregate.aggregate?s.account_transactions_aggregate.aggregate.count:0}async function yo(t){let{aptosConfig:n,accountAddress:e,options:o}=t,s={owner_address:{_eq:a.from(e).toStringLong()}},c={query:h,variables:{where_condition:s,offset:o?.pagination?.offset,limit:o?.pagination?.limit,order_by:o?.orderBy}};return(await d({aptosConfig:n,query:c,originMethod:"getAccountCoinsData"})).current_fungible_asset_balances}async function mo(t){let{aptosConfig:n,accountAddress:e}=t,o=a.from(e).toStringLong(),s=await d({aptosConfig:n,query:{query:C,variables:{address:o}},originMethod:"getAccountCoinsCount"});if(!s.current_fungible_asset_balances_aggregate.aggregate)throw Error("Failed to get the count of account coins");return s.current_fungible_asset_balances_aggregate.aggregate.count}async function _o(t){let{aptosConfig:n,accountAddress:e,options:o}=t,s={owner_address:{_eq:a.from(e).toStringLong()}},c={query:k,variables:{where_condition:s,offset:o?.pagination?.offset,limit:o?.pagination?.limit,order_by:o?.orderBy}};return(await d({aptosConfig:n,query:c,originMethod:"getAccountOwnedObjects"})).current_objects}async function Co(t){let{aptosConfig:n,privateKey:e}=t,o=new _(e.publicKey());if(e instanceof m){let s=A.fromPublicKeyAndScheme({publicKey:o,scheme:2}).derivedAddress();return f.fromPrivateKeyAndAddress({privateKey:e,address:s})}if(e instanceof y){let r=A.fromPublicKeyAndScheme({publicKey:o,scheme:2});if(await P({authKey:r,aptosConfig:n})){let u=r.derivedAddress();return f.fromPrivateKeyAndAddress({privateKey:e,address:u,legacy:!1})}let c=A.fromPublicKeyAndScheme({publicKey:o,scheme:0});if(await P({authKey:c,aptosConfig:n})){let u=c.derivedAddress();return f.fromPrivateKeyAndAddress({privateKey:e,address:u,legacy:!0})}}throw new Error(`Can't derive account from private key ${e}`)}async function P(t){let{aptosConfig:n,authKey:e}=t,o=await Q({aptosConfig:n,authenticationKey:e.derivedAddress()});try{return await M({aptosConfig:n,accountAddress:o}),!0}catch(r){if(r.status===404)return!1;throw new Error(`Error while looking for an account info ${o.toString()}`)}}export{M as a,co as b,ao as c,io as d,uo as e,K as f,Q as g,go as h,po as i,Ao as j,fo as k,lo as l,yo as m,mo as n,_o as o,Co as p,P as q};
//# sourceMappingURL=chunk-CMKDTJGM.mjs.map